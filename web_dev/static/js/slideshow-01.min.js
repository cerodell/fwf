(function(b){var c={LOOP_CONTINUOUS:0,LOOP_ONCE:1,LOOP_REFLECT:2};var j={imgNum:0,imgLen:0,allImages:new Array(),epochDates:[],loopSpeed:300,loopInterval:null,currentlyLooping:false,loopFwd:true,loopType:c.LOOP_CONTINUOUS,speedChange:false,MAX_LOOP_SPEED:50,MIN_LOOP_SPEED:900,currentDatetime:null,defaultTZ:"UTC",currentTZ:"UTC",currentTZName:"UTC"};var f=["UTC","Canada/Pacific","Canada/Mountain","Canada/Central","Canada/Eastern","Canada/Atlantic","Canada/Newfoundland"];var a=function(k){return k<10?"0"+k:k};var e=function(k){paddedDateElements=[k.year(),a(k.month()+1),a(k.date())];return paddedDateElements.join("-")+" "+a(k.hour())+":"+a(k.minute())};var h=function(){var k=[];for(i in f){k.push(moment(new Date()).tz(f[i]).zoneAbbr())}j.tzOptions=k;var l="";for(i in k){l+="<option "+(j.currentTZ===f[i]?'selected="selected"':"")+' value="'+moment.tz.zone(f[i]).name+'">'+j.tzOptions[i]+"</option>"}document.getElementById("timezone-options").innerHTML=l};var d=function(){j.currentTZ=j.defaultTZ;if(typeof(Storage)!=="undefined"){if(localStorage.getItem("timeZone")!==null){j.currentTZ=localStorage.getItem("timeZone")}}};var g=function(){if(typeof(Storage)!=="undefined"){localStorage.setItem("timeZone",j.currentTZ)}};b("#timezone-options").on("change",function(){var k=b(this).val();if(k!=j.currentTZ){j.currentTZ=k}j.currentDatetime=j.currentDatetime.tz(j.currentTZ);document.querySelector("#currenttime").innerHTML=e(j.currentDatetime);g()});b.fn.slideShow=function(){return this.each(function(){var v=this.getElementsByTagName("img");b(this.children).not("img").remove();for(var r=v.length-1;r>=0;r--){var o=v[r].src;j.allImages.unshift(o);j.epochDates.unshift(b(v[r]).data("date"));if(r!=0){v[r].parentNode.removeChild(v[r])}}j.imgNum=0;j.imgLen=j.allImages.length-1;d();h();var u=document.getElementById("slideshow-controls");u.style.display="block";var l=document.createElement("Input");var A={value:j.imgNum,type:"range",id:"ssRangeSlider",min:0,max:j.imgLen,step:0,title:String(j.imgNum)+"/"+String(j.imgLen)};for(var z in A){l.setAttribute(z,A[z])}var u=document.getElementById("slideshow-controls");u.insertBefore(l,u.firstChild);var y=b("#firstImage");y.on("click",function(){b(this).firstImage()});var q=b("#prevImage");q.on("click",function(){b(this).prevImage()});var w=b("#autoLoop");w.on("click",function(){b(this).auto()});var x=b("#nextImage");x.on("click",function(){b(this).nextImage()});var n=b("#lastImage");n.on("click",function(){b(this).lastImage()});var p=b("#increaseSpeed");p.on("click",function(){b(this).increaseSpeed()});var m=b("#decreaseSpeed");m.on("click",function(){b(this).decreaseSpeed()});var k=b("#ssOnce");k.on("click",function(){b(this).checkLoopState()});var s=b("#ssLoop");s.on("click",function(){b(this).checkLoopState()});var t=document.getElementById("ssRangeSlider");if(t.addEventListener){t.addEventListener("input",function(){var B=parseInt(t.value);b(this).jump2Image(B)},false)}else{if(t.attachEvent){t.attachEvent("change",function(){var B=parseInt(t.value);b(this).jump2Image(B)})}}b(this).firstImage()})};b.fn.checkLoopState=function(){if(document.getElementById("ssOnce").checked){j.loopFwd=true;j.loopType=c.LOOP_ONCE}else{if(document.getElementById("ssLoop").checked){j.loopFwd=true;j.loopType=c.LOOP_CONTINUOUS}else{if(document.getElementById("ssReflect").checked){j.loopType=c.LOOP_REFLECT}}}};b.fn.auto=function(){if(j.currentlyLooping){this.clearLoopInterval()}else{j.currentlyLooping=true;b(document.getElementById("autoLoop").getElementsByTagName("span")[0]).removeClass("glyphicon-play").addClass("glyphicon-pause");if(j.imgNum>=j.imgLen&&j.loopType==c.LOOP_ONCE){j.imgNum=-1}this.autoLoopFwd()}};b.fn.autoLoopFwd=function(){j.loopFwd=true;j.loopInterval=setInterval(function(){b(this).changeImage(1)},j.loopSpeed)};b.fn.autoLoopRev=function(){j.loopRev=false;j.loopInterval=setInterval(function(){b(this).changeImage(-1)},j.loopSpeed)};b.fn.changeImage=function(l){if(j.speedChange){j.speedChange=false;this.clearLoopInterval();if(l>0){this.autoLoopFwd()}else{if(l<0){this.autoLoopRev()}}}var k=j.imgNum+parseInt(l);j.imgNum+=parseInt(l);if(j.loopType==c.LOOP_ONCE){if(j.imgNum>j.imgLen&&j.currentlyLooping){j.imgNum=j.imgLen;this.clearLoopInterval()}else{if(j.imgNum>j.imgLen){j.imgNum=0}}}else{if(j.loopType==c.LOOP_CONTINUOUS){if(j.imgNum>j.imgLen){j.imgNum=0}else{if(j.imgNum<0){j.imgNum=j.imgLen}}}}document.getElementById("ssRangeSlider").value=j.imgNum;b.fn.jump2Image(j.imgNum)};b.fn.nextImage=function(){if(j.currentlyLooping){this.clearLoopInterval()}this.changeImage(1)};b.fn.prevImage=function(){if(j.currentlyLooping){this.clearLoopInterval()}this.changeImage(-1)};b.fn.firstImage=function(){if(j.currentlyLooping){this.clearLoopInterval()}j.imgNum=0;document.getElementById("ssRangeSlider").value=j.imgNum;this.jump2Image(j.imgNum)};b.fn.lastImage=function(){if(j.currentlyLooping){this.clearLoopInterval()}j.imgNum=j.imgLen;document.getElementById("ssRangeSlider").value=j.imgNum;this.jump2Image(j.imgNum)};b.fn.jump2Image=function(k){if(k>j.imgLen){k=j.imgLen}else{if(k<0){k=0}}j.imgNum=k;var m=j.allImages[j.imgNum];document.querySelector("#slideshow img").src=m;var l=moment.tz(parseInt(j.epochDates[j.imgNum],10),"UTC");if(j.currentTZ!=j.defaultTZ){datetimeAware=l.tz(j.currentTZ)}else{datetimeAware=l}j.currentDatetime=datetimeAware;formattedDateString=e(datetimeAware);document.querySelector("#currenttime").innerHTML=formattedDateString};b.fn.increaseSpeed=function(){if(j.currentlyLooping){j.speedChange=true}this.changeSpeed(-50)};b.fn.decreaseSpeed=function(){if(j.currentlyLooping){j.speedChange=true}this.changeSpeed(50)};b.fn.changeSpeed=function(k){j.loopSpeed+=parseInt(k);if(j.loopSpeed<j.MAX_LOOP_SPEED){j.loopSpeed=j.MAX_LOOP_SPEED}else{if(j.loopSpeed>j.MIN_LOOP_SPEED){j.loopSpeed=j.MIN_LOOP_SPEED}}};b.fn.clearLoopInterval=function(){j.currentlyLooping=false;b(document.getElementById("autoLoop").getElementsByTagName("span")[0]).removeClass("glyphicon-pause").addClass("glyphicon-play");window.clearInterval(j.loopInterval)};b.fn.getOptions=function(){return j}}(jQuery));$("#slideshow").slideShow();
