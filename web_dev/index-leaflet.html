<!DOCTYPE html>
<html lang="en">

<head>    
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    

    <title>Fire Weather Forecast</title>

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
    integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf"
    crossorigin="anonymous">

    <script src="https://cdn.jsdelivr.net/npm/leaflet@1.6.0/dist/leaflet.js"></script>
    <script src="https://cdn.maptiler.com/mapbox-gl-js/v1.5.1/mapbox-gl.js"></script>
    <script src="https://cdn.maptiler.com/mapbox-gl-leaflet/latest/leaflet-mapbox-gl.js"></script>
    <link rel="stylesheet" href="static/css/fwf-mapbox.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.6.0/dist/leaflet.css"/>
    <link rel="stylesheet" href="https://cdn.rawgit.com/socib/Leaflet.TimeDimension/master/dist/leaflet.timedimension.control.min.css">
    <link rel='stylesheet' href='https://api.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v1.0.1/leaflet.fullscreen.css'>

    <style>html, body {width: 100%;height: 100%;margin: 0;padding: 0;}</style>
    <style>#map {position:absolute;top:0;bottom:0;right:0;left:0;}</style>
    
    <style>#map_fwi {width: 100.0%;height: 100.0%;left: 0.0%;top: 0.0%;}</style>

    <!-- <script src="https://unpkg.com/leaflet.vectorgrid@latest/dist/Leaflet.VectorGrid.bundled.js"></script> -->
    <!-- <script src="https://unpkg.com/geojson-vt@3.2.0/geojson-vt.js"></script> -->
    <script src='https://api.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v1.0.1/Leaflet.fullscreen.min.js'></script>
    <script src="https://cdn.plot.ly/plotly-1.54.6.min.js"></script>
    <link rel="stylesheet" href="static/css/fwf-leaflet.zoomhome.css"/>
    <!-- <link rel="stylesheet" href="static/css/fwf-map-style.css"/> -->
    <link rel="stylesheet" href="static/css/fwf-opacity.css"/>

    <link rel="stylesheet" href="static/js/Control.Opacity.css" />

    <link rel="stylesheet" href="static/css/jquery-ui-1.10.3.custom.min.css" />

    <script src="static/js/Control.Opacity.js"></script>


    <script src="static/js/jquery-1.9.1.js"></script>
    <script src="static/js/jquery-ui-1.10.3.custom.min.js"></script>

</head>


<body>

    <div class="fwi-map" id="map_fwi"></div>
    <!-- <div class="fwi-plot" id="plot_fwi"></div> -->


    <!-- <script src="https://code.jquery.com/jquery-3.4.1.min.js"
    integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
    crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"
    integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU="
    crossorigin="anonymous"></script> -->
    <script src="https://cdn.rawgit.com/nezasa/iso8601-js-period/master/iso8601.min.js"></script>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js"></script> -->
    <!-- <script src="//cdnjs.cloudflare.com/ajax/libs/jqueryui-touch-punch/0.2.2/jquery.ui.touch-punch.min.js"></script> -->
    <!-- <script src="https://cdn.rawgit.com/nezasa/iso8601-js-period/master/iso8601.min.js"></script> -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/leaflet-timedimension@1.1.1/dist/leaflet.timedimension.min.js"></script>
    <script src="static/js/fwf-leaflet.zoomhome.min.js"></script>
    <script src="static/js/fwf-Leaflet.VectorGrid.bundled.min.js"></script>
    <!-- <script src="https://unpkg.com/leaflet.vectorgrid@latest/dist/Leaflet.VectorGrid.bundled.js"></script> -->


    <!-- <script src="static/js/fwf-leaflet.groupedlayercontrol.min.js"></script> -->
    <!-- <script src="static/js/fwf-leaflet.ajax.min.js"></script> -->
    <!-- <script src="static/js/fwf-leaflet-opacity.js"></script> -->
    <!-- <script src="static/js/fwf-time-layer-group.js"></script> -->
    <!-- <script src="static/js/fwf-kdbush.min.js"></script> -->
    <script src="https://d3js.org/d3-color.v1.min.js"></script>
    <script src="https://d3js.org/d3-interpolate.v1.min.js"></script>

    <script src="static/js/fwf-colorbars.js"></script>
    <script src="static/js/fwf-time-layer-group.js"></script>

    <script src="static/js/interpolate.js"></script>

    <script>
        var map = L.map(
            "map_fwi",
            {
                center: [53.684414, -98.44137],
                crs: L.CRS.EPSG3857,
                zoom: 3,
                minZoom: 3,
                maxZoom: 14,
                maxBounds: [
                //south west
                [-80, 360],
                //north east
                [80,-360]
                ], 
                zoomControl: true,
                preferCanvas: false,
                fullscreenControl: true,
                timeDimension: true,
                timeDimensionOptions: {
                    // format should be "yyyy-mm-ddThh:mm:ssZ"
                    timeInterval: "2020-08-17T00:00:00Z/2020-08-19T00:00:00Z",
                    period: "PT6H",
                    currentTime: Date.parse("2020-08-17T00:00:00Z"),
                },
                timeDimensionControl: true,
                timeDimensionControlOptions: {
                    autoPlay: false,
                    playButton: true,
                    speedSlider: true,
                    // timeSteps: 1,
                    timeZones: ["UTC", "Local"],
                    playerOptions: {
                        // loop: true,
                        transitionTime: 1000,
                    },
                },
            });

        // var numberOfItems = 8;
        // var rainbow = new Rainbow(); 
        // rainbow.setNumberRange(1, numberOfItems);
        // rainbow.setSpectrum('red', 'black');
        // var s = '';
        // for (var i = 1; i <= numberOfItems; i++) {
        //     var hexColour = rainbow.colourAt(i);
        //     s += '#' + hexColour + ', ';
        // };
    
        // console.log(s); 

    //     var url = 'data/ffmc-2020081700.pbf'

    // var vectorTileOptions = {
    // rendererFactory: L.canvas.tile,
    // vectorTileLayerStyles: {

        
    //     "FFMC": function(properties, zoom) {
    //     console.log(properties);

	//     if (fill === "000080") {   // point
	//         return (
    //             {"color": "#000080", "opacity": opacity, "fillColor": "#000080",
    //              "fillOpacity": fillOpacity, "weight": 0.2, fill: true}  
    //             )
    //              }
    //         }
    //     }
    // };
    //     var proto = L.vectorGrid.protobuf(url, {
    //                     getFeatureId: function(f) {
    //                         console.log(f.properties)
    //                         return f.properties.FFMC;
    //                     }
    //                 }).addTo(map);

    // var i = d3.interpolateNumber(10, 20);
    // console.log(i);

        layerGroup = L.layerGroup().addTo(map);
        var url = 'data/ffmc-2020081700.json'
        fetch(url).then(function(response){
                    return response.json();
                }).then(function(json){
                    var vector = L.vectorGrid.slicer( json, {
                        minZoom: 2,
                        maxzoom: 18,
                        rendererFactory: L.canvas.tile,
                        vectorTileLayerStyles:{
                            'FFMC': geo_json_styler18
                                }
                            }
                        )
                        console.log(vector);      
                layerGroup.addLayer(vector)});


            // var ffmc_topo_file = 'data/ffmc-2020081700.json';
        // var geo_json_ffmc = L.layerGroup().addTo(map);

        // var ffmcTimeLayer = L.timeDimension.layer.layerGroup(geo_json_ffmc, {
        //     getUrlFunction: getHourlyForecast,
        //     getFileDir: ffmc_topo_file,
        //     getVar: 'FFMC'

        // });
        // ffmcTimeLayer.addTo(map);

  
    </script>

<script src="static/js/fwf-basemaps.js"></script>




    <!-- Google analytics -->
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-103958338-1', 'auto');
        ga('send', 'pageview');
    </script> 
        <!-- end Google Analytics -->
  </body>
</html>